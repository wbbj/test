<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>

</head>
<body>
<div id="show"></div>
<form id="log">
用户名:<input type="text" name="username" id="username"/>
密码:<input type="password" name="username" id="password"/>

</form>
<button id="login">登录</button>
</body>

<script>
// window.onload=function () {
//   $.ajax(
//       {
//           type:'get',
//           datatype:'text',
//           url:'index'
//       }
//   )
// };
$(function () {
    $("#login").click(
      function () {

          $.ajax({
              type:'POST',
              dataType:'text',
              url:'LoginServlet',
              data:"username="+escape($('#username').val())+"&password="+escape($('#password').val()),
              contentType: 'application/x-www-form-urlencoded',
              success: function (msg) {
                  if(msg==="用户名或密码错误"){
                      window.location.reload();
                  }
                  else if(msg==="1"){
                      window.location.replace("http://localhost:8080/test/");
                  }
                  else {
                      alert("error");
                  }
              }
          })
      }
    );
});
//    function f() {
//        var username=document.getElementById("username").value;
//        var password=document.getElementById("password").value;
//
//        var formData=new FormData();
//        formData.append("username",username);
//        formData.append("password",password);
//        var xhr=new XMLHttpRequest();
//        var url = "/test/LoginServlet";
//        xhr.open("post",url,true);
//
//        xhr.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
//        xhr.onreadystatechange=function () {
//            if(xhr.readyState===4&&xhr.readyState===200){
//                alert(xhr.responseText);
//            }
//            else {
//                document.getElementById("show").innerHTML="error";
//            }
//        };
//        xhr.send(formData);
//        // xhr.send(data);
//    }
</script>

</html>